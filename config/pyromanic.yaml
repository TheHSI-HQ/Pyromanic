## (C) 2025 TheHSI
## All rights reserved
##
## : pyromanic.yaml
##   Pyromanic main config file
##
## Comments: ##
## Commented Option: #
## Option: key: value
##
## Secrets from secrets.yaml can be accessed using "[[secret_name_here]]"
##
version: v1.0.8
## --- DO NOT MODIFY ABOVE THIS LINE ---

## Enables Pyromanic [true]
enabled: true

## App Settings
app:
  ## App Branding
  branding:
    ## Branding Name [default]
    name: default

    ## Branding Icon [passthrough]
    ## Option:
    ## - default : The Default Icon
    ## - passthrough : Uses the Icon of the Application behind Pyromanic
    ## - *://*/* : An External Icon
    icon: passthrough

  ## App Base Path [/pyro]
  base_path: /pyro

## Auth Settings
auth:
  ## Auth Key Expiry [30 days 00:00:00]
  expires:
    days: 30
    hours: 0
    minutes: 0
    seconds: 0

  ## Interval between Expiry Checks (seconds) [600]
  check_interval: 600

  ## Application Secret [[application_secret]]
  secret: "[[application_secret]]"

  ## Rate Limit Settings
  rate_limit:
    ## How many attempts before being ratelimited [3]
    attempts: 3

    ## How long to Remember Rate Limit Flags (seconds) [10]
    remember: 60

## Debug Settings (Use Defaults in Production)
debug:
  ## Record Traffic Handle Time to ./assets/metrics.csv [false]
  record_metrics: false

## Logging Setting
logging:
  ## Enabled Logging [true]
  enabled: true

  ## Show IPs in Log [true]
  show_ips: true

  ## Log File: PATH | off [off]
  file: off

  ## Log to Console [true]
  console: true

## Database Settings
database:
  ## Database Type sqlite/mysql/postgresql [mysql]
  type: mysql

  ## Database Name (ignored for sqlite) [pyromanic]
  database: pyromanic

  ## Host of the Database (ignored for sqlite) [localhost:3306]
  host: localhost:3306

  ## User for the Database (ignored for sqlite) [pyromanic]
  user: pyromanic

  ## Password for the Database (ignored for sqlite) [[database_password]]
  password: "[[database_password]]"

  ## Database File (only for sqlite) [./database.sqlite3]
  file: ./database.sqlite3

## Proxy Settings
proxy:
  ## Client IP Headers [X-Forwarded-For]
  ## The Client IP will be set as the Value for these Headers,
  ## Previous Value will be overwritten!
  remote_ip_header:
    - X-Forwarded-For

  ## Skip X-Pyromanic Header [false]
  skip_x-pyromanic: false

  ## Add additional Data to the Request [empty]
  ## In this format:
  ## - type: cookie | header | parameter
  ##   key: X-Some-Key
  ##   value: SomeValue
  additional_data:

  ## Remove a Header from the Response
  strip_headers:
    #- X-Dummy

  ## Allowed HTTP Methods [GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH]
  ## Options: GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH
  allowed_methods:
    - GET
    - HEAD
    - POST
    - PUT
    - DELETE
    - CONNECT
    - OPTIONS
    - TRACE
    - PATCH

  ## Where to get Client IP from [source]
  ## Options:
  ## - source : Use the IP the request originated from
  ## - header[X-Header-Name] : Header of the Request (e.g. header[X-Forwarded-For])
  ## - parameter[url-parameter] : Use a URL parameter (e.g. param[origin] : .../path?origin=1.2.3.4). Will be removed before Proxying
  ## - url : Assumes the last part behind the / in the url to be the IP (e.g. .../example/1.2.3.4). Will be removed before Proxying
  remote_ip_method: source

  ## Stop Modifications to the Original Request [false]
  no_modify: false

  ## Stops all Modifications to the Original Request [false]
  ## this includes routing info, may cause unexpected behaviour
  ## Requires proxy.no_modify to be true
  strict_no_modify: false

  ## Remote Server Root URL [http://localhost:5000/]
  web_root: http://localhost:5000/

  ## Remote Connection Timeout in Sec [30]
  timeout: 30

  ## Proxies Request to the Remote Server [none, none]
  ## Supports these formats:
  ## - socks5://host:port
  ## - socks5://user:pass@host:port
  ## - socks5h://host:port
  ## - socks5h://user:pass@host:port
  ## - none
  proxy:
    http: none
    https: none

## Caching Settings
cache:
  ## Cache Enabled [true]
  enabled: true

  ## Cache Duration in Seconds [900]
  duration: 900

## HTTP Settings
http:
  ## HTTP Enabled [true]
  enabled: false

  ## HTTP Port [80]
  port: 80

  ## HTTP Host [0.0.0.0]
  host: 0.0.0.0

## HTTPS Settings
https:
  ## HTTPS Enabled [true]
  enabled: true

  ## Use insecure SSL/TLS [false]
  adhoc: false

  ## Certificate Path [./server.crt]
  certificate: ./server.crt

  ## Private Key Path [./server.key]
  private_key: ./server.key

  ## HTTPS Port [443]
  port: 443

  ## HTTP Host [0.0.0.0]
  host: 0.0.0.0
